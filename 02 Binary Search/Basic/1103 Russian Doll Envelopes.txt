/*
LIS Explanation - Striver
Code from - https://leetcode.com/problems/russian-doll-envelopes/solutions/82763/java-nlogn-solution-with-explanation-by-gq7yc
Extension of LIS 300 leetcode problem
1. Sort the array. Ascend on width and descend on height if width are same.
2. Find the longest increasing subsequence based on height.

We want to apply LIS (Longest Increasing Subsequence) on heights after sorting.
(5,4) (5,5)
if we sort by increasing heights - then LIS will be 2
which is wrong so we sort by descending heights
(5,5), (5,4)
LIS = 1

LIS 300. leetcode question - Striver Explanation
https://youtu.be/on2hvxBXJH4?t=559
 */
class Solution {
    public int maxEnvelopes(int[][] envelopes) {
    if(envelopes == null || envelopes.length == 0 
       || envelopes[0] == null || envelopes[0].length != 2)
        return 0;
    //sort the array, ascend on width, descend on height
    Arrays.sort(envelopes, new Comparator<int[]>(){
        public int compare(int[] arr1, int[] arr2){
            if(arr1[0] == arr2[0])
                return arr2[1] - arr1[1];
            else
                return arr1[0] - arr2[0];
       }
    });
    
    //create dp size, whenever next element is higher keep adding
    //when its less, find its position and replace the element
    int[] dp = new int[envelopes.length];
    int size = 0;
        
    for(int[] envelope: envelopes) {
        // binary search
        int left = 0, right = size, middle = 0;     // right = size
        while(left < right) {
            middle = left + (right - left) / 2;
            if(dp[middle] < envelope[1]) left = middle + 1;
            else right = middle;
        }
        
        // left is the right position to 'replace' in dp array
        dp[left] = envelope[1];
        if(left == size) size++;
    }
    
    return size;
}
}
