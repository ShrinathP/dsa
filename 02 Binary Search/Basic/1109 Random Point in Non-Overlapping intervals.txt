

/*

Chatgpt solution

Algorithm (concise steps)
1. Precompute area
  - For each rectangle [x1,y1,x2,y2]
  - area = (x2 - x1 + 1) * (y2 - y1 + 1)
2. Build prefix sum
  - prefix[i] = total points till rectangle i
3. Pick random number
  - Generate k ∈ [1, totalPoints]
4. Binary search
  - Find rectangle where prefix[i] ≥ k
5. Pick random point inside rectangle  
  - x = x1 + rand % width
  - y = y1 + rand % height
*/

class Solution {
    int[][] rects;
    int[] prefix;
    int total;
    Random rand;

    public Solution(int[][] rects) {
        this.rects = rects;
        rand = new Random();
        prefix = new int[rects.length];

        int sum = 0;
        for (int i = 0; i < rects.length; i++) {
            int[] r = rects[i];
            int area = (r[2] - r[0] + 1) * (r[3] - r[1] + 1);
            sum += area; 
            prefix[i] = sum; //maintain prefix sum
        }
        total = sum; //find total sum
    }

    public int[] pick() {
        int k = rand.nextInt(total) + 1; //random target

        int idx = Arrays.binarySearch(prefix, k); //check for target in prefixSum array
        if (idx < 0) idx = -idx - 1;

        //get rectangle, get random x r[2] - r[0] and y r[3] - r[1] 
        int[] r = rects[idx];
        int x = r[0] + rand.nextInt(r[2] - r[0] + 1);
        int y = r[1] + rand.nextInt(r[3] - r[1] + 1);

        return new int[]{x, y};
    }
}

